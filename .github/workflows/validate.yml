name: Pipeline Est치ndar Profesional
on: [push]

permissions:
  contents: write
  pages: write
  id-token: write

jobs:
  quality-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # 1. HTMLHint: Revisa accesibilidad y etiquetas obsoletas
      - name: Linter de Buenas Pr치cticas (HTMLHint)
        run: |
          npm install -g htmlhint
          htmlhint "**/*.html" --rules "tag-pair=true,id-unique=true,src-not-empty=true,attr-value-not-empty=true,doctype-first=true,tag-self-close=false,spec-char-escape=false"

      # 2. Stylelint: Revisa que el CSS no tenga errores sint치cticos
      - name: Validador de CSS
        run: |
          npm install -g stylelint stylelint-config-standard
          npx stylelint "**/*.css" --allow-empty-input --config '{ "extends": "stylelint-config-standard" }'

      # 3. ESLint: Detecta errores de l칩gica y sintaxis en JS
      - name: Validador de JavaScript (ESLint)
        run: |
          npm install -g eslint
          npx eslint "**/*.js" --no-eslintrc --rule 'no-undef: error' --rule 'no-unused-vars: warn' --allow-empty-files || true

  deploy:
    needs: quality-check
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v4
      - name: Deploy a GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./